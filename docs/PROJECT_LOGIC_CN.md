# DistCapsule 项目演示逻辑 (Slide Flow)

这份文档对应最新的 LaTeX 演示文稿 (V2.1)，用于快速梳理答辩逻辑。

---

## 1. 背景与目标 (Contexte)
*   **痛点**：公共咖啡角的胶囊通常散乱堆放，不仅**占用桌面空间**，还难以分辨口味；有些用户不得不将胶囊藏在别处，使用不便。
*   **解决方案**：一个垂直化、集中式的智能胶囊分发塔。
*   **核心价值**：**"收纳+分发"** —— 既节省了桌面空间，又通过生物识别实现了便捷的个性化取用。
*   **当前状态**：**V1.1 Prod**（硬件、软件、App 全线完工）。

---

## 2. 系统架构 (Architecture)
我们采用经典的 **三层架构 (3-Tier)**，实现了解耦与稳定：

1.  **Android App (Java)**
    *   **角色**：遥控器 & 管理台。
    *   **通信**：通过 REST API 发送指令 (JSON)。
2.  **API Server (FastAPI)**
    *   **角色**：交通枢纽。
    *   **职责**：验证 Token，将指令写入数据库 (`Pending_Commands`)。
3.  **Core Agent (Python)**
    *   **角色**：执行者。
    *   **职责**：轮询数据库，驱动舵机，控制屏幕，处理人脸识别。

### 关键网络设计：标准热点 (Standard Hotspot)
*   **问题**：无网关的“静默热点”经常被现代 Android/iOS 系统判定为“受限连接”并自动断开。
*   **解决**：启用 DHCP 网关 (Gateway Enabled)。
*   **效果**：极大提升了连接稳定性。虽然手机可能暂时无法使用 4G 上网，但这确保了演示过程中的控制链路绝对可靠。我们在 App 中增加了一键切换 Wi-Fi 的按钮来简化操作。

---

## 3. 移动端体验 (Android V1.1)
### 界面设计：Vivid Palette
为了让操作直观，我们设计了一套**语义化配色系统**：
*   🟢 **翠绿 (Emerald)**：状态正常 / 已录入 / 成功。
*   🟡 **向日葵黄 (Sunflower)**：需要行动 / 待录入 / 连接 Wi-Fi。
*   🔴 **珊瑚红 (Coral)**：危险操作 / 删除账户。

### 安全与管理
*   **Admin Protection**：
    *   管理员 (ID 1) **不可被删除**。
    *   管理界面中，如果选中了管理员账号，操作按钮会自动**隐藏**，防止误操作。
*   **动态 UI**：
    *   只有在下拉框选中了具体用户后，操作面板（通道分配、录入）才会弹出。
*   **隐私**：
    *   用户点击 "Supprimer mon compte" -> 本地 Token 清除 + 硬件端生物数据同步擦除。

---

## 4. 硬件与工程 (Hardware)
### 核心挑战：Pi 5 的变革
*   **问题**：Raspberry Pi 5 换了芯片 (RP1)，导致老牌库 `RPi.GPIO` 失效。
*   **攻克**：重写底层驱动，使用 **`lgpio`** 库并手写 **Soft-PWM** 算法，实现了 5 个舵机的平滑控制。

### 3D 设计：Code-to-CAD
*   使用 **OpenSCAD** (代码建模)。
*   **优势**：参数化设计。胶囊直径变了？改一行代码，整个底座自动重构。

---

## 5. 总结 (Bilan)
*   **完成度**：
    *   ✅ **App**：原生 Java，Retrofit 网络库，Material Design 3。
    *   ✅ **后端**：FastAPI 异步架构，SQLite 自动迁移。
    *   ✅ **硬件**：IPS 屏驱动，舵机阵列，指纹/人脸双重识别。
*   **下一步**：
    *   现场演示 (Live Demo)。
    *   外壳总装。

---
*备注文档，仅供演讲者参考。*